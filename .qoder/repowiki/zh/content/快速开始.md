# 快速开始

<cite>
**本文档引用的文件**   
- [README.md](file://README.md) - *已更新以反映最新安装说明*
- [nuxt.config.ts](file://nuxt.config.ts) - *已更新以包含新模块和配置*
- [package.json](file://package.json) - *已更新以包含自选模型和模板工具依赖*
- [app/components/ModelSelect.vue](file://app/components/ModelSelect.vue) - *新增功能：自选模型组件*
- [server/core/tools/mcp-tools.ts](file://server/core/tools/mcp-tools.ts) - *新增功能：模板工具集成*
- [shared/types/model.ts](file://shared/types/model.ts) - *定义可用AI模型列表*
- [server/api/chat.post.ts](file://server/api/chat.post.ts) - *集成模板工具的聊天API*
- [server/utils/model.ts](file://server/utils/model.ts) - *AI模型服务配置*
</cite>

## 更新摘要
**已做更改**   
- 更新了依赖说明以包含新增的AI模型和工具相关依赖
- 扩展了Nuxt配置详解，新增`@unocss/nuxt`模块说明
- 新增“自选模型功能”和“模板工具”两个功能说明章节
- 修正了环境变量配置部分，明确运行时配置的实际使用方式
- 更新了完整操作流程示例以反映最新项目状态

## 目录
1. [简介](#简介)
2. [项目结构](#项目结构)
3. [安装依赖](#安装依赖)
4. [启动开发服务器](#启动开发服务器)
5. [构建生产版本](#构建生产版本)
6. [Nuxt配置详解](#nuxt配置详解)
7. [自选模型功能](#自选模型功能)
8. [模板工具](#模板工具)
9. [常见问题排查](#常见问题排查)
10. [完整操作流程示例](#完整操作流程示例)

## 简介
本指南旨在为新手开发者提供一份详细的入门教程，指导如何在本地环境部署和运行code_gen项目。内容涵盖了从克隆仓库到启动开发服务器的完整流程，以及新引入的自选模型功能和模板工具的使用方法。通过本指南，即使没有项目背景的开发者也能快速上手并开始开发工作。

## 项目结构
code_gen项目采用Nuxt框架构建，具有清晰的目录结构。主要目录包括：
- **app**: 应用程序的主要代码，包含组件、组合式函数、页面、状态管理等
- **server**: 服务器端API和核心逻辑
- **shared**: 共享的类型定义和工具函数
- 根目录包含配置文件如package.json、nuxt.config.ts等

这种结构遵循了现代前端项目的最佳实践，将前端代码与服务器逻辑分离，便于维护和扩展。

## 安装依赖
要运行code_gen项目，首先需要安装项目依赖。项目使用pnpm作为包管理器，这是推荐的安装方式。

### 安装步骤
1. 确保已安装Node.js（建议版本16以上）和pnpm
2. 克隆项目仓库：
```bash
git clone https://github.com/All_in_Ai/code_gen.git
cd code_gen
```
3. 安装依赖：
```bash
pnpm install
```

### 依赖说明
根据package.json文件，项目依赖主要包括：
- **核心框架**: nuxt@^4.0.3, vue@^3.5.18
- **UI组件库**: element-plus@^2.10.7, @element-plus/nuxt@^1.1.4
- **状态管理**: @pinia/nuxt@^0.11.2
- **AI集成**: @ai-sdk/openai@^2.0.16, ai@^5.0.16
- **开发工具**: @nuxt/eslint@1.8.0, typescript@^5.9.2
- **新功能依赖**: @modelcontextprotocol/sdk@^1.17.4 (模板工具), ollama-ai-provider-v2@^1.1.1 (AI模型支持)

**Section sources**
- [package.json](file://package.json#L1-L47)

## 启动开发服务器
安装完依赖后，可以启动开发服务器进行本地开发。

### 启动命令
```bash
pnpm dev -o
```

### 参数说明
- `pnpm dev`: 运行package.json中定义的dev脚本，该脚本执行`nuxt dev`命令
- `-o`: 自动在默认浏览器中打开应用

### 预期输出
开发服务器将在`http://localhost:3000`启动。如果端口3000被占用，Nuxt会自动尝试其他端口。

**Section sources**
- [README.md](file://README.md#L10-L15)

## 构建生产版本
当开发完成并准备部署时，需要构建生产版本。

### 构建命令
```bash
pnpm build
```

### 构建过程
该命令会执行`nuxt build`，完成以下操作：
1. 编译TypeScript代码
2. 优化和压缩前端资源
3. 生成静态文件
4. 准备生产环境的部署包

### 预览生产版本
构建完成后，可以本地预览生产版本：
```bash
pnpm preview
```
这将启动一个本地服务器来预览构建后的应用，确保一切正常后再进行部署。

**Section sources**
- [README.md](file://README.md#L18-L27)

## Nuxt配置详解
nuxt.config.ts是Nuxt项目的核心配置文件，定义了项目的各种行为和特性。

### 关键配置项分析
```typescript
export default defineNuxtConfig({
  ssr: false,
  compatibilityDate: '2025-07-15',
  devtools: { enabled: true },
  modules: ['@nuxt/eslint', '@element-plus/nuxt', '@pinia/nuxt', '@unocss/nuxt'],
  runtimeConfig: {
    siliconFlowApiUrl: '',
    siliconFlowApiKey: '',
  },
  alias: {
    '#server': fileURLToPath(new URL('./server', import.meta.url)),
  },
  unocss: {
    nuxtLayers: true,
  },
});
```

#### SSR配置
- `ssr: false`: 禁用服务端渲染（SSR），项目将以客户端渲染（CSR）模式运行
- 这种配置适合不需要SEO优化的内部工具或管理后台

#### 模块引入
- `@nuxt/eslint`: 集成ESLint进行代码质量检查
- `@element-plus/nuxt`: 集成Element Plus UI组件库
- `@pinia/nuxt`: 集成Pinia状态管理库
- `@unocss/nuxt`: 集成UnoCSS原子化CSS框架，支持图层功能

#### 运行时配置
- `runtimeConfig`: 定义运行时环境变量
- `siliconFlowApiUrl`和`siliconFlowApiKey`: 用于AI服务的API配置，需要在部署时设置

#### 别名配置
- `#server`: 指向服务器目录的别名，便于在代码中引用服务器端模块

**Section sources**
- [nuxt.config.ts](file://nuxt.config.ts#L1-L23)

## 自选模型功能
项目新增了自选模型功能，允许用户在界面上选择不同的AI模型进行对话。

### 功能组件
- **ModelSelect.vue**: 模型选择组件，提供下拉式模型选择界面
- **AvailableModels**: 在`shared/types/model.ts`中定义的可用模型列表

### 可用模型列表
```typescript
export const AvailableModels: ModelOption[] = [
  {
    id: 'deepseek-ai/DeepSeek-R1',
    name: 'DeepSeek-R1',
    description: '最新推理模型，擅长数学和编程',
  },
  {
    id: 'deepseek-ai/DeepSeek-V3.1',
    name: 'DeepSeek-V3.1',
    description: '通用对话模型，平衡性能优秀',
  },
  {
    id: 'Qwen/Qwen2.5-72B-Instruct-128K',
    name: 'Qwen2.5-72B',
    description: '大参数模型，支持128K上下文',
  },
  {
    id: 'Qwen/Qwen3-Coder-480B-A35B-Instruct',
    name: 'Qwen3-Coder-480B',
    description: '专业代码生成模型，超大参数',
  },
  {
    id: 'Qwen/Qwen3-Coder-30B-A3B-Instruct',
    name: 'Qwen3-Coder-30B',
    description: '轻量级代码生成模型',
  },
];
```

### 使用方式
1. 在聊天界面点击"选择模型"按钮
2. 从弹出的模型列表中选择所需的AI模型
3. 选择后，后续对话将使用选定的模型

**Section sources**
- [app/components/ModelSelect.vue](file://app/components/ModelSelect.vue#L1-L153)
- [shared/types/model.ts](file://shared/types/model.ts#L22-L48)

## 模板工具
项目集成了模板工具，通过MCP（Model Context Protocol）协议提供模板生成功能。

### 核心实现
- **mcp-tools.ts**: 定义了模板工具客户端的创建和初始化
- **initMcpTools**: 异步函数，用于初始化并返回可用的模板工具

### 工具配置
```typescript
const templateClientPromise = experimental_createMCPClient({
  transport: new StdioClientTransport({
    command: 'uv',
    args: [
      '--directory',
      'E:/GitHub/All_in_Ai/test_mcp_server',
      'run',
      'template_mcp',
    ],
  }),
});
```

### 集成方式
模板工具已集成到聊天API中，在`server/api/chat.post.ts`文件中调用：
```typescript
const tools = await initMcpTools();
// ... 在streamText调用中使用tools
```

### 使用前提
- 需要安装`uv`命令行工具
- 需要存在`test_mcp_server`测试服务器项目
- 需要正确配置MCP服务的运行环境

**Section sources**
- [server/core/tools/mcp-tools.ts](file://server/core/tools/mcp-tools.ts#L1-L32)
- [server/api/chat.post.ts](file://server/api/chat.post.ts#L11-L15)

## 常见问题排查
在部署和运行过程中可能会遇到一些常见问题，以下是解决方案。

### 依赖安装失败
**问题**: pnpm install命令执行失败
**解决方案**:
1. 确保网络连接正常
2. 清除pnpm缓存：`pnpm store prune`
3. 检查pnpm版本：`pnpm --version`，建议使用最新稳定版
4. 如果使用代理，配置pnpm代理：`pnpm config set proxy http://your-proxy:port`

### 端口占用
**问题**: 开发服务器无法在3000端口启动
**解决方案**:
1. 检查端口占用：`netstat -ano | findstr :3000`（Windows）或`lsof -i :3000`（macOS/Linux）
2. 终止占用进程或使用其他端口：`pnpm dev -p 3001`
3. 在nuxt.config.ts中配置自定义端口：
```typescript
export default defineNuxtConfig({
  nitro: {
    port: 3001
  }
});
```

### 环境变量缺失
**问题**: 运行时提示API密钥或URL缺失
**解决方案**:
1. 创建`.env`文件，添加必要的环境变量：
```
NUXT_PUBLIC_SILICON_FLOW_API_URL=your-api-url
NUXT_PUBLIC_SILICON_FLOW_API_KEY=your-api-key
```
2. 重新启动开发服务器
3. 确保环境变量名以`NUXT_PUBLIC_`开头，以便在客户端访问
4. 服务端配置通过`useRuntimeConfig()`获取，如`server/utils/model.ts`中的实现

**Section sources**
- [nuxt.config.ts](file://nuxt.config.ts#L7-L11)
- [README.md](file://README.md#L10-L15)
- [server/utils/model.ts](file://server/utils/model.ts#L16-L25)

## 完整操作流程示例
以下是从零开始的完整操作流程：

```bash
# 1. 克隆仓库
git clone https://github.com/All_in_Ai/code_gen.git
cd code_gen

# 2. 安装依赖
pnpm install

# 3. （可选）配置环境变量
echo "NUXT_PUBLIC_SILICON_FLOW_API_URL=https://api.example.com" > .env
echo "NUXT_PUBLIC_SILICON_FLOW_API_KEY=your-secret-key" >> .env

# 4. 启动开发服务器
pnpm dev -o

# 5. （在另一个终端）构建生产版本
pnpm build

# 6. 预览生产版本
pnpm preview
```

此流程验证了README.md中的安装说明，确保了指南的准确性和可执行性。

**Section sources**
- [README.md](file://README.md#L6-L27)