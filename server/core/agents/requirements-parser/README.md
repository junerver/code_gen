# Requirements Parser Agent

è¿™æ˜¯ä¸€ä¸ªåŸºäºäººå·¥æ™ºèƒ½å¢å¼ºçš„è‡ªç„¶è¯­è¨€éœ€æ±‚è§£æä»£ç†ï¼Œå®ƒå°†ç”¨æˆ·çš„è‡ªç„¶è¯­è¨€éœ€æ±‚è½¬æ¢ä¸ºç»“æ„åŒ–çš„æŠ€æœ¯è§„èŒƒã€‚

## åŠŸèƒ½ç‰¹æ€§

### ğŸ§  æ™ºèƒ½è§£æèƒ½åŠ›
- **å®ä½“è¯†åˆ«**: è‡ªåŠ¨è¯†åˆ«ä¸šåŠ¡å®ä½“åŠå…¶å±æ€§
- **å…³ç³»æŠ½å–**: åˆ†æå®ä½“é—´çš„å…³è”å…³ç³»
- **ä¸šåŠ¡è§„åˆ™æå–**: è¯†åˆ«ä¸šåŠ¡çº¦æŸå’ŒéªŒè¯è§„åˆ™
- **å¤šè½®å¯¹è¯æ¾„æ¸…**: é’ˆå¯¹æ¨¡ç³Šéœ€æ±‚ç”Ÿæˆæ¾„æ¸…é—®é¢˜

### ğŸ“Š ç½®ä¿¡åº¦è¯„ä¼°
- **ç»¼åˆè¯„åˆ†**: 0-1 èŒƒå›´çš„ç½®ä¿¡åº¦è¯„åˆ†
- **å¤šå› å­åˆ†æ**: å®ä½“è¯†åˆ«ã€å…³ç³»æ¸…æ™°åº¦ã€è§„åˆ™å®Œæ•´æ€§ã€æ¨¡ç³Šç¨‹åº¦ã€é¢†åŸŸåŒ¹é…åº¦ã€ç»“æ„å®Œæ•´æ€§
- **æ”¹è¿›å»ºè®®**: é’ˆå¯¹ä½ç½®ä¿¡åº¦é¡¹ç›®æä¾›å…·ä½“æ”¹è¿›å»ºè®®

### ğŸ¯ é¢†åŸŸä¸“ä¸šçŸ¥è¯†
- **é¢„å®šä¹‰é¢†åŸŸ**: ç”µå•†ã€å†…å®¹ç®¡ç†ã€ç”¨æˆ·ç®¡ç†ã€é¢„è®¢ç³»ç»Ÿç­‰
- **é¢†åŸŸåŒ¹é…**: è‡ªåŠ¨è¯†åˆ«éœ€æ±‚æ‰€å±çš„ä¸šåŠ¡é¢†åŸŸ
- **ä¸šåŠ¡è§„åˆ™åº“**: å„é¢†åŸŸç‰¹å®šçš„å¸¸è§ä¸šåŠ¡è§„åˆ™
- **å®ä½“æ¨¡æ¿**: é¢†åŸŸç›¸å…³çš„å¸¸è§å®ä½“ç»“æ„

## æ¶æ„è®¾è®¡

```
requirements-parser/
â”œâ”€â”€ types.ts              # TypeScript ç±»å‹å®šä¹‰
â”œâ”€â”€ domain-knowledge.ts   # é¢†åŸŸçŸ¥è¯†åº“
â”œâ”€â”€ confidence-scorer.ts  # ç½®ä¿¡åº¦è¯„ä¼°ç³»ç»Ÿ
â”œâ”€â”€ index.ts              # ä¸»è§£æå™¨å®ç°
â”œâ”€â”€ examples.ts           # ä½¿ç”¨ç¤ºä¾‹å’Œæµ‹è¯•ç”¨ä¾‹
â””â”€â”€ test-integration.ts   # é›†æˆæµ‹è¯•
```

## å®‰è£…å’Œå¯¼å…¥

```typescript
// åŸºç¡€ä½¿ç”¨
import { parseRequirements } from '#server/core/agents/requirements-parser';

// é«˜çº§ä½¿ç”¨
import { RequirementsParserAgent } from '#server/core/agents/requirements-parser';
```

## ä½¿ç”¨æ–¹æ³•

### åŸºæœ¬è§£æ

```typescript
const result = await parseRequirements(
  'æˆ‘éœ€è¦ä¸€ä¸ªç”µå•†å¹³å°ï¼Œç”¨æˆ·å¯ä»¥è´­ä¹°å•†å“ï¼Œæ”¯æŒå¤šç§æ”¯ä»˜æ–¹å¼'
);

if (result.success) {
  console.log('è§£æç»“æœ:', result.data);
  console.log('ç½®ä¿¡åº¦:', result.data.confidence);
  console.log('é¢†åŸŸ:', result.data.domain);
}
```

### é«˜çº§é…ç½®

```typescript
const parser = new RequirementsParserAgent({
  model: 'Qwen3-Coder-30B',
  temperature: 0.3,
  includeConfidenceAnalysis: true,
  context: {
    domain: 'ecommerce',
    previousRequirements: ['ä¹‹å‰çš„éœ€æ±‚æè¿°'],
    userAnswers: { 'æ¾„æ¸…é—®é¢˜': 'ç”¨æˆ·å›ç­”' }
  }
});

const result = await parser.parse(requirementText);
```

### ç”Ÿæˆé¢å¤–æ¾„æ¸…é—®é¢˜

```typescript
const additionalQuestions = await parser.generateAdditionalQuestions(
  parsedRequirement,
  'ç”¨æˆ·å¸Œæœ›æ·»åŠ æ›´å¤šåŠŸèƒ½'
);
```

## API ç«¯ç‚¹

### è§£æéœ€æ±‚
```
POST /api/requirements/parse

è¯·æ±‚ä½“:
{
  "text": "è‡ªç„¶è¯­è¨€éœ€æ±‚æè¿°",
  "options": {
    "model": "Qwen3-Coder-30B",
    "temperature": 0.3,
    "includeConfidenceAnalysis": true
  }
}
```

### ç”Ÿæˆæ¾„æ¸…é—®é¢˜
```
POST /api/requirements/clarify

è¯·æ±‚ä½“:
{
  "currentRequirement": { /* å½“å‰è§£æç»“æœ */ },
  "context": "éœ€è¦æ¾„æ¸…çš„ä¸Šä¸‹æ–‡",
  "model": "Qwen3-Coder-30B"
}
```

## è¿”å›æ•°æ®ç»“æ„

### æˆåŠŸè§£æ
```json
{
  "success": true,
  "data": {
    "id": "uuid",
    "originalText": "åŸå§‹éœ€æ±‚æ–‡æœ¬",
    "entities": [ /* å®ä½“åˆ—è¡¨ */ ],
    "relationships": [ /* å…³ç³»åˆ—è¡¨ */ ],
    "businessRules": [ /* ä¸šåŠ¡è§„åˆ™ */ ],
    "clarificationNeeded": [ /* æ¾„æ¸…é—®é¢˜ */ ],
    "confidence": 0.85,
    "confidenceFactors": {
      "entityRecognition": 0.9,
      "relationshipClarity": 0.8,
      "ruleCompleteness": 0.7,
      "ambiguityLevel": 0.6,
      "domainMatch": 1.0,
      "structuralCompleteness": 0.8
    },
    "domain": "ecommerce",
    "complexity": "medium"
  }
}
```

### éœ€è¦æ¾„æ¸…
```json
{
  "success": true,
  "data": {
    "clarificationNeeded": [
      {
        "id": "uuid",
        "question": "å…·ä½“é—®é¢˜",
        "context": "ä¸ºä»€ä¹ˆéœ€è¦æ¾„æ¸…",
        "priority": "high",
        "category": "functional"
      }
    ],
    "confidence": 0.25
  }
}
```

## é¢†åŸŸæ”¯æŒ

### ç”µå•† (ecommerce)
- å•†å“ç®¡ç†ã€è®¢å•å¤„ç†ã€åº“å­˜æ§åˆ¶
- æ”¯ä»˜é›†æˆã€ç”¨æˆ·ç®¡ç†ã€è´­ç‰©è½¦
- å¸¸è§å®ä½“: Product, Order, User, Category, Cart, Payment

### å†…å®¹ç®¡ç† (content_management)
- æ–‡ç« å‘å¸ƒã€åˆ†ç±»ç®¡ç†ã€æ ‡ç­¾ç³»ç»Ÿ
- è¯„è®ºç®¡ç†ã€å†…å®¹å®¡æ ¸ã€SEOä¼˜åŒ–
- å¸¸è§å®ä½“: Article, Category, Tag, User, Comment

### ç”¨æˆ·ç®¡ç† (user_management)
- ç”¨æˆ·è®¤è¯ã€è§’è‰²æƒé™ã€ä¼šè¯ç®¡ç†
- å¯†ç ç­–ç•¥ã€åŒå› å­è®¤è¯ã€ä¸ªäººèµ„æ–™
- å¸¸è§å®ä½“: User, Role, Permission, Profile, Session

### é¢„è®¢ç³»ç»Ÿ (booking)
- èµ„æºé¢„è®¢ã€æ—¶é—´ç®¡ç†ã€å¯ç”¨æ€§æ£€æŸ¥
- é¢„è®¢å®¡æ‰¹ã€æ”¯ä»˜å®šé‡‘ã€å–æ¶ˆç­–ç•¥
- å¸¸è§å®ä½“: Booking, Resource, TimeSlot, User, Availability

## æœ€ä½³å®è·µ

### 1. æä¾›å…·ä½“çš„éœ€æ±‚æè¿°
```typescript
// âŒ è¿‡äºæ¨¡ç³Š
"æˆ‘éœ€è¦ä¸€ä¸ªäººäº‹ç³»ç»Ÿ"

// âœ… å…·ä½“æ˜ç¡®
"æˆ‘éœ€è¦ä¸€ä¸ªäººäº‹ç³»ç»Ÿï¼Œæ”¯æŒå‘˜å·¥ä¿¡æ¯ç®¡ç†ã€è¯·å‡ç”³è¯·æµç¨‹ã€è–ªèµ„è®¡ç®—ã€‚å‘˜å·¥ä¿¡æ¯åŒ…æ‹¬åŸºæœ¬ä¿¡æ¯ã€éƒ¨é—¨ã€èŒä½ã€‚è¯·å‡æµç¨‹éœ€è¦éƒ¨é—¨ç»ç†å®¡æ‰¹ï¼Œæ”¯æŒäº‹å‡ã€ç—…å‡ã€å¹´å‡ã€‚è–ªèµ„è®¡ç®—éœ€è¦æ”¯æŒåŸºæœ¬å·¥èµ„ã€ç»©æ•ˆå¥–é‡‘ã€ç¤¾ä¿æ‰£é™¤ã€‚"
```

### 2. ä½¿ç”¨ä¸“ä¸šæœ¯è¯­
```typescript
// âŒ ç”Ÿæ´»åŒ–æè¿°
"ç”¨æˆ·å¯ä»¥ç™»å½•ç³»ç»Ÿï¼Œçœ‹çœ‹è‡ªå·±çš„ä¿¡æ¯"

// âœ… æŠ€æœ¯åŒ–æè¿°
"ç”¨æˆ·é€šè¿‡é‚®ç®±å’Œå¯†ç ç™»å½•ç³»ç»Ÿï¼Œå¯ä»¥æŸ¥çœ‹å’Œç¼–è¾‘ä¸ªäººèµ„æ–™ï¼ŒåŒ…æ‹¬å§“åã€è”ç³»æ–¹å¼ã€å¤´åƒç­‰ä¿¡æ¯"
```

### 3. æ˜ç¡®ä¸šåŠ¡è§„åˆ™
```typescript
// âœ… åŒ…å«ä¸šåŠ¡è§„åˆ™
"ç”¨æˆ·æ³¨å†Œéœ€è¦é‚®ç®±éªŒè¯ï¼Œå¯†ç å¿…é¡»åŒ…å«å­—æ¯å’Œæ•°å­—ï¼Œé•¿åº¦8-20ä½ã€‚ç”¨æˆ·è¿ç»­ç™»å½•å¤±è´¥5æ¬¡åè´¦æˆ·é”å®š15åˆ†é’Ÿã€‚"
```

## ç½®ä¿¡åº¦è¯„ä¼°

ç½®ä¿¡åº¦è¯„åˆ†åŸºäºå…­ä¸ªç»´åº¦ï¼š

1. **å®ä½“è¯†åˆ«** (25%): å®ä½“ç»“æ„çš„å®Œæ•´æ€§å’Œè§„èŒƒæ€§
2. **å…³ç³»æ¸…æ™°åº¦** (20%): å®ä½“é—´å…³ç³»çš„æ˜ç¡®æ€§å’Œåˆç†æ€§
3. **è§„åˆ™å®Œæ•´æ€§** (20%): ä¸šåŠ¡è§„åˆ™çš„è¯¦ç»†ç¨‹åº¦å’Œè¦†ç›–é¢
4. **æ¨¡ç³Šç¨‹åº¦** (15%): åŸå§‹éœ€æ±‚æè¿°çš„æ˜ç¡®æ€§
5. **é¢†åŸŸåŒ¹é…** (10%): éœ€æ±‚ä¸é¢†åŸŸçš„åŒ¹é…åº¦
6. **ç»“æ„å®Œæ•´æ€§** (10%): æ•´ä½“ç»“æ„çš„å¹³è¡¡æ€§

## é”™è¯¯å¤„ç†

### å¸¸è§é”™è¯¯
```typescript
{
  "success": false,
  "error": "Validation failed",
  "validationErrors": [
    {
      "field": "entities",
      "message": "At least one entity must be identified"
    }
  ],
  "retryable": true,
  "suggestion": "Try providing more specific requirements with clear business entities"
}
```

### é‡è¯•æœºåˆ¶
ç³»ç»Ÿä¼šè‡ªåŠ¨é‡è¯•æœ€å¤š3æ¬¡ï¼Œå¦‚æœä»ç„¶å¤±è´¥ï¼Œä¼šæä¾›å…·ä½“çš„æ”¹è¿›å»ºè®®ã€‚

## æ€§èƒ½ä¼˜åŒ–

- æ”¯æŒç¼“å­˜æœºåˆ¶ï¼Œé¿å…é‡å¤è§£æç›¸åŒéœ€æ±‚
- å¼‚æ­¥å¤„ç†ï¼Œä¸é˜»å¡ä¸»æµç¨‹
- ç½®ä¿¡åº¦ä½äºé˜ˆå€¼æ—¶è‡ªåŠ¨è¯·æ±‚æ¾„æ¸…
- æ”¯æŒæ‰¹é‡å¤„ç†å’Œæµå¼å“åº”

## æ›´æ–°æ—¥å¿—

- v1.0.0: åˆå§‹ç‰ˆæœ¬ï¼Œæ”¯æŒåŸºç¡€éœ€æ±‚è§£æå’Œç½®ä¿¡åº¦è¯„ä¼°
- æ”¯æŒé¢†åŸŸçŸ¥è¯†åº“å’Œå¤šè½®å¯¹è¯æ¾„æ¸…
- æä¾›å®Œæ•´çš„APIæ¥å£å’Œé”™è¯¯å¤„ç†